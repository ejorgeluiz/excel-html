<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel HTML</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            margin: 20px;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
        }

        .spreadsheet {
            padding: 20px;
        }

        .column-headers {
            display: flex;
            background: #34495e;
            color: white;
            border-radius: 4px 4px 0 0;
        }

        .row-header {
            width: 50px;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            background: #2c3e50;
        }

        .column-header {
            flex: 1;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            border-right: 1px solid #2c3e50;
        }

        .column-header:last-child {
            border-right: none;
        }

        .input-area {
            border: 2px solid #34495e;
            border-top: none;
            border-radius: 0 0 4px 4px;
            min-height: 400px;
            background: white;
        }

        .row {
            display: flex;
            border-bottom: 1px solid #ecf0f1;
        }

        .row:hover {
            background-color: #f8f9fa;
        }

        .row-number {
            width: 50px;
            padding: 8px;
            background: #ecf0f1;
            border-right: 1px solid #bdc3c7;
            text-align: center;
            font-weight: bold;
            color: #7f8c8d;
        }

        .cell {
            flex: 1;
            border-right: 1px solid #ecf0f1;
        }

        .cell:last-child {
            border-right: none;
        }

        .cell input {
            width: 100%;
            padding: 8px 12px;
            border: none;
            outline: none;
            font-size: 14px;
            background: transparent;
            box-sizing: border-box;
        }

        .cell input:focus {
            background-color: #e3f2fd;
            box-shadow: inset 2px 0 0 #2196f3;
        }

        .formula-cell input {
            background-color: #fff3e0;
            font-family: 'Courier New', monospace;
        }

        .formula-cell input:focus {
            background-color: #ffe0b2;
            box-shadow: inset 2px 0 0 #ff9800;
        }

        .results {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .result-card.coluna-a {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .result-card.coluna-b {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .result-card.coluna-c {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }

        .result-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .result-value {
            font-size: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .add-row-btn {
            width: 100%;
            padding: 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .add-row-btn:hover {
            background: #2980b9;
        }

        .instructions {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 4px 4px 0;
        }

        .instructions p {
            margin: 5px 0;
            color: #2c5530;
        }

        .formula-help {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 10px;
            margin-top: 10px;
            border-radius: 0 4px 4px 0;
            font-size: 12px;
        }

        .formula-help p {
            margin: 2px 0;
            color: #e65100;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Excel HTML</h1>
        </div>
        
        <div class="spreadsheet">
            <div class="instructions">
                <p><strong>Como usar:</strong></p>
                <p>‚Ä¢ <strong>Coluna A e B:</strong> Digite valores num√©ricos - soma e contagem autom√°ticas</p>
                <p>‚Ä¢ <strong>Coluna C (F√≥rmulas):</strong> Digite opera√ß√µes matem√°ticas como: 2+3, 10*5, 100/4, etc.</p>
            </div>
            
            <div class="column-headers">
                <div class="row-header">#</div>
                <div class="column-header">Coluna A</div>
                <div class="column-header">Coluna B</div>
                <div class="column-header">Coluna C (F√≥rmulas)</div>
            </div>
            
            <div class="input-area" id="inputArea">
                <!-- Linhas ser√£o geradas aqui -->
            </div>
            
            <button class="add-row-btn" onclick="addRow()">‚ûï Adicionar Nova Linha</button>
            
            <div class="formula-help">
                <p><strong>Exemplos de f√≥rmulas para Coluna C:</strong></p>
                <p>‚Ä¢ Adi√ß√£o: 5+3 ‚Ä¢ Subtra√ß√£o: 10-4 ‚Ä¢ Multiplica√ß√£o: 6*7 ‚Ä¢ Divis√£o: 20/4</p>
                <p>‚Ä¢ Pot√™ncia: 2^3 ‚Ä¢ Par√™nteses: (10+5)*2 ‚Ä¢ Decimais: 3.14*2</p>
            </div>
            
            <div class="results">
                <div class="result-card coluna-a">
                    <div class="result-label">COLUNA A - SOMA</div>
                    <div class="result-value" id="sumA">0</div>
                </div>
                
                <div class="result-card coluna-a">
                    <div class="result-label">COLUNA A - QTD</div>
                    <div class="result-value" id="countA">0</div>
                </div>
                
                <div class="result-card coluna-b">
                    <div class="result-label">COLUNA B - SOMA</div>
                    <div class="result-value" id="sumB">0</div>
                </div>
                
                <div class="result-card coluna-b">
                    <div class="result-label">COLUNA B - QTD</div>
                    <div class="result-value" id="countB">0</div>
                </div>
                
                <div class="result-card coluna-c">
                    <div class="result-label">COLUNA C - SOMA</div>
                    <div class="result-value" id="sumC">0</div>
                </div>
                
                <div class="result-card coluna-c">
                    <div class="result-label">COLUNA C - QTD</div>
                    <div class="result-value" id="countC">0</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let rowCount = 0;
        
        // Fun√ß√£o para criar uma nova linha
        function createRow(rowNum) {
            const row = document.createElement('div');
            row.className = 'row';
            row.innerHTML = `
                <div class="row-number">${rowNum}</div>
                <div class="cell">
                    <input type="text" 
                           placeholder="Digite um valor..." 
                           oninput="calculateResults()" 
                           onkeypress="handleEnter(event, ${rowNum}, 0)">
                </div>
                <div class="cell">
                    <input type="text" 
                           placeholder="Digite um valor..." 
                           oninput="calculateResults()" 
                           onkeypress="handleEnter(event, ${rowNum}, 1)">
                </div>
                <div class="cell formula-cell">
                    <input type="text" 
                           placeholder="Ex: 2+3, 10*5, 100/4..." 
                           oninput="calculateResults()" 
                           onkeypress="handleEnter(event, ${rowNum}, 2)">
                </div>
            `;
            return row;
        }
        
        // Fun√ß√£o para adicionar uma nova linha
        function addRow() {
            rowCount++;
            const inputArea = document.getElementById('inputArea');
            const newRow = createRow(rowCount);
            inputArea.appendChild(newRow);
            
            // Foca no primeiro input da nova linha
            const firstInput = newRow.querySelector('input');
            firstInput.focus();
            
            calculateResults();
        }
        
        // Fun√ß√£o para avaliar express√µes matem√°ticas de forma segura
        function evaluateExpression(expr) {
            try {
                // Remove espa√ßos e substitui ^ por **
                expr = expr.replace(/\s/g, '').replace(/\^/g, '**');
                
                // Verifica se a express√£o cont√©m apenas n√∫meros, operadores e par√™nteses
                if (!/^[0-9+\-*/.()^**\s]+$/.test(expr)) {
                    return NaN;
                }
                
                // Avalia a express√£o
                return Function('"use strict"; return (' + expr + ')')();
            } catch (e) {
                return NaN;
            }
        }
        
        // Fun√ß√£o para calcular soma e contagem de todas as colunas
        function calculateResults() {
            const rows = document.querySelectorAll('#inputArea .row');
            
            let sumA = 0, countA = 0;
            let sumB = 0, countB = 0;
            let sumC = 0, countC = 0;
            
            rows.forEach(row => {
                const inputs = row.querySelectorAll('input');
                
                // Coluna A
                const valueA = parseFloat(inputs[0].value);
                if (!isNaN(valueA) && inputs[0].value.trim() !== '') {
                    sumA += valueA;
                    countA++;
                }
                
                // Coluna B
                const valueB = parseFloat(inputs[1].value);
                if (!isNaN(valueB) && inputs[1].value.trim() !== '') {
                    sumB += valueB;
                    countB++;
                }
                
                // Coluna C (f√≥rmulas)
                const exprC = inputs[2].value.trim();
                if (exprC !== '') {
                    const resultC = evaluateExpression(exprC);
                    if (!isNaN(resultC) && isFinite(resultC)) {
                        sumC += resultC;
                        countC++;
                        
                        // Mostra o resultado da f√≥rmula no placeholder
                        inputs[2].style.color = '#2e7d32';
                        inputs[2].title = `Resultado: ${resultC}`;
                    } else {
                        inputs[2].style.color = '#d32f2f';
                        inputs[2].title = 'F√≥rmula inv√°lida';
                    }
                } else {
                    inputs[2].style.color = '';
                    inputs[2].title = '';
                }
            });
            
            // Atualiza os resultados na interface
            document.getElementById('sumA').textContent = sumA.toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            document.getElementById('countA').textContent = countA;
            
            document.getElementById('sumB').textContent = sumB.toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            document.getElementById('countB').textContent = countB;
            
            document.getElementById('sumC').textContent = sumC.toLocaleString('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            document.getElementById('countC').textContent = countC;
        }
        
        // Fun√ß√£o para lidar com Enter (move para pr√≥xima c√©lula)
        function handleEnter(event, currentRow, currentCol) {
            if (event.key === 'Enter') {
                event.preventDefault();
                
                const rows = document.querySelectorAll('#inputArea .row');
                const currentRowElement = rows[currentRow - 1];
                
                if (currentCol < 2) {
                    // Move para pr√≥xima coluna na mesma linha
                    const nextInput = currentRowElement.querySelectorAll('input')[currentCol + 1];
                    nextInput.focus();
                } else {
                    // Move para primeira coluna da pr√≥xima linha
                    if (currentRow < rows.length) {
                        const nextRowElement = rows[currentRow];
                        const nextInput = nextRowElement.querySelector('input');
                        nextInput.focus();
                    } else {
                        // Cria nova linha se for a √∫ltima
                        addRow();
                    }
                }
            }
        }
        
        // Inicializar com algumas linhas
        function init() {
            for (let i = 0; i < 8; i++) {
                addRow();
            }
        }
        
        // Inicializar quando a p√°gina carregar
        window.onload = init;
    </script>
</body>
</html>
